<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{admin/fragments/layout :: head('Список специального предложения')}">
  <title>Специальные предложения</title>
</head>
<body>
<!-- Подключение боковой панели -->
<div th:replace="~{admin/fragments/sidebar :: sidebar}"></div>

<!-- Основной контент -->
<main class="main-content">
  <!-- Верхняя панель -->
  <header class="topbar">
    <button class="hamburger-btn">
      <i class="fas fa-bars"></i>
    </button>
    <div class="user-menu">
      <span class="user-name">Администратор</span>
      <a href="/logout" class="logout-btn"><i class="fas fa-sign-out-alt"></i></a>
    </div>
  </header>

  <!-- Содержимое страницы -->
  <div class="content-wrapper">
    <div class="container">
      <div class="page-header d-flex justify-content-between align-items-center">
        <h1 class="page-title">Специальные предложения</h1>
        <div>
          <a th:href="@{/admin/special-offers/create}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Создать новое предложение
          </a>
          <form th:action="@{/admin/special-offers/deactivate-expired}" method="post" class="d-inline">
            <button type="submit" class="btn btn-warning">
              <i class="fas fa-clock"></i> Деактивировать просроченные
            </button>
          </form>
        </div>
      </div>

      <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
        <span th:text="${successMessage}"></span>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
              <tr>
                <th scope="col">ID</th>
                <th scope="col">Название</th>
                <th scope="col">Скидка</th>
                <th scope="col">Цветов в акции</th>
                <th scope="col">Осталось дней</th>
                <th scope="col">Статус</th>
                <th scope="col">Действия</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="offer : ${offers}">
                <td th:text="${offer.id}"></td>
                <td th:text="${offer.name}"></td>
                <td>
                    <span th:if="${offer.discountPercentage > 0}"
                          th:text="${offer.discountPercentage + '%'}"></span>
                  <span th:if="${offer.specialPriceText}"
                        th:text="${offer.specialPriceText}"></span>
                </td>
                <td th:text="${offer.flowerCount}"></td>
                <td>
                  <span th:text="${offer.remainingDays + ' дн.'}"></span>
                </td>
                <td>
                  <span th:if="${offer.remainingDays > 0}" class="badge badge-success">Активно</span>
                  <span th:unless="${offer.remainingDays > 0}" class="badge badge-danger">Истекло</span>
                </td>
                <td>
                  <div class="action-buttons">
                    <a th:href="@{/admin/special-offers/{id}(id=${offer.id})}"
                       class="btn-action view" title="Просмотр">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a th:href="@{/admin/special-offers/{id}/edit(id=${offer.id})}"
                       class="btn-action edit" title="Редактировать">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a th:href="@{/admin/special-offers/{id}/manage-flowers(id=${offer.id})}"
                       class="btn-action manage" title="Управление цветами">
                      <i class="fas fa-leaf"></i>
                    </a>
                    <form th:action="@{/admin/special-offers/{id}/deactivate(id=${offer.id})}"
                          method="post" class="d-inline">
                      <button type="submit" class="btn-action delete" title="Деактивировать"
                              onclick="return confirm('Вы уверены, что хотите деактивировать это предложение?')">
                        <i class="fas fa-ban"></i>
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Подключение скриптов -->
<div th:replace="~{admin/fragments/layout :: scripts}"></div>
</body>
</html>